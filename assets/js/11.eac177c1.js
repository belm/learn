(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{366:function(a,t,s){"use strict";s.r(t);var e=s(45),l=Object(e.a)({},(function(){var a=this,t=a.$createElement,s=a._self._c||t;return s("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[s("h1",{attrs:{id:"elk"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#elk"}},[a._v("#")]),a._v(" ELK")]),a._v(" "),s("p",[a._v("（Elasticsearch & Logstash & Kibana）")]),a._v(" "),s("p",[a._v("[TOC]")]),a._v(" "),s("h3",{attrs:{id:"elasticsearch"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#elasticsearch"}},[a._v("#")]),a._v(" Elasticsearch")]),a._v(" "),s("h4",{attrs:{id:"下载"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#下载"}},[a._v("#")]),a._v(" 下载")]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("https://www.elastic.co/cn/downloads/elasticsearch\n")])])]),s("h4",{attrs:{id:"目录说明"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#目录说明"}},[a._v("#")]),a._v(" 目录说明")]),a._v(" "),s("table",[s("thead",[s("tr",[s("th",[a._v("目录")]),a._v(" "),s("th",[a._v("配置文件")]),a._v(" "),s("th",[a._v("描述")])])]),a._v(" "),s("tbody",[s("tr",[s("td",[a._v("bin")]),a._v(" "),s("td"),a._v(" "),s("td",[a._v("脚本文件，包括启动elasticsearch，安装插件。运行统计数据等")])]),a._v(" "),s("tr",[s("td",[a._v("config")]),a._v(" "),s("td",[a._v("elasticsearch.yml")]),a._v(" "),s("td",[a._v("集群配置文件，user, role based 相关配置")])]),a._v(" "),s("tr",[s("td",[a._v("JDK")]),a._v(" "),s("td"),a._v(" "),s("td",[a._v("内置Java运行环境")])]),a._v(" "),s("tr",[s("td",[a._v("data")]),a._v(" "),s("td",[a._v("path.data")]),a._v(" "),s("td",[a._v("数据文件")])]),a._v(" "),s("tr",[s("td",[a._v("lib")]),a._v(" "),s("td"),a._v(" "),s("td",[a._v("Java类库")])]),a._v(" "),s("tr",[s("td",[a._v("logs")]),a._v(" "),s("td",[a._v("path.log")]),a._v(" "),s("td",[a._v("日志文件")])]),a._v(" "),s("tr",[s("td",[a._v("modules")]),a._v(" "),s("td"),a._v(" "),s("td",[a._v("包含所有ES模块")])]),a._v(" "),s("tr",[s("td",[a._v("plugins")]),a._v(" "),s("td"),a._v(" "),s("td",[a._v("包含所有已安装插件")])])])]),a._v(" "),s("h4",{attrs:{id:"jvm配置"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#jvm配置"}},[a._v("#")]),a._v(" JVM配置")]),a._v(" "),s("ul",[s("li",[a._v("修改JVM -  config/jvm.options    7.1版本 默认设置为1GB")]),a._v(" "),s("li",[a._v("配置的建议\n"),s("ul",[s("li",[a._v("Xmx和Xms 设置成一样")]),a._v(" "),s("li",[a._v("Xmx 不要超过机器内存的50%")]),a._v(" "),s("li",[a._v("不要超过30GB")])])])]),a._v(" "),s("h4",{attrs:{id:"启动elasticsearch"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#启动elasticsearch"}},[a._v("#")]),a._v(" 启动elasticsearch")]),a._v(" "),s("p",[a._v("简单启动")]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("前台启动\nbin/elasticsearch\n后台启动\nbin/elasticsearch -d\n")])])]),s("p",[a._v("集群启动")]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("bin/elasticsearch -E node.name=node0 -E cluster.name=test -E path.data=node0_data -d\nbin/elasticsearch -E node.name=node1 -E cluster.name=test -E path.data=node1_data -d\nbin/elasticsearch -E node.name=node2 -E cluster.name=test -E path.data=node2_data -d\nbin/elasticsearch -E node.name=node3 -E cluster.name=test -E path.data=node3_data -d\n")])])]),s("p",[a._v("web查看启动的节点")]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("http://localhost:9200/_cat/nodes\n")])])]),s("p",[a._v("杀掉集群进程")]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("ps aux|grep elasticsearch\nkill pid\n")])])]),s("h4",{attrs:{id:"安装插件和查看安装的插件"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#安装插件和查看安装的插件"}},[a._v("#")]),a._v(" 安装插件和查看安装的插件")]),a._v(" "),s("p",[a._v("查看已经安装的插件")]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("bin/elasticsearch-plugin list\n")])])]),s("p",[a._v("安装插件")]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("bin/elasticsearch-plugin install  analysis-icu\n")])])]),s("p",[a._v("web查看已经安装的插件")]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("http://localhost:9200/_cat/plugins\n")])])]),s("p",[a._v("ElasticSearch提供插件的机制对系统进行扩展")]),a._v(" "),s("ul",[s("li",[a._v("Discovery Plugin")]),a._v(" "),s("li",[a._v("Analysis Plugin")]),a._v(" "),s("li",[a._v("Security Plugin")]),a._v(" "),s("li",[a._v("Management Plugin")]),a._v(" "),s("li",[a._v("Ingest Plugin")]),a._v(" "),s("li",[a._v("Mapper Plugin")]),a._v(" "),s("li",[a._v("Backup Plugin")])]),a._v(" "),s("h4",{attrs:{id:"查看启动情况"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#查看启动情况"}},[a._v("#")]),a._v(" 查看启动情况")]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("http://localhost:9200\n")])])]),s("h3",{attrs:{id:"kibana"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#kibana"}},[a._v("#")]),a._v(" Kibana")]),a._v(" "),s("h4",{attrs:{id:"下载-2"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#下载-2"}},[a._v("#")]),a._v(" 下载")]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("https://www.elastic.co/cn/downloads/kibana\n")])])]),s("h4",{attrs:{id:"启动-先启动elasticsearch"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#启动-先启动elasticsearch"}},[a._v("#")]),a._v(" 启动 （先启动elasticsearch）")]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("bin/kibana\n")])])]),s("h4",{attrs:{id:"查看"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#查看"}},[a._v("#")]),a._v(" 查看")]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("http://localhost:5601\n")])])]),s("ul",[s("li",[a._v("可以导入sample数据方便学习（首页）")]),a._v(" "),s("li",[a._v("重点关注 dev_tools  可查看elastic的数据  比如 Console 输入 get  /_cat/nodes 查看节点")])]),a._v(" "),s("h4",{attrs:{id:"插件"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#插件"}},[a._v("#")]),a._v(" 插件")]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("安装插件\nbin/kibana-plugin install plugin_location\n查看插件\nbin/kibana-plugin list\n移除插件\nbin/kibana-plugin remove xxx\n")])])]),s("h3",{attrs:{id:"logstash"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#logstash"}},[a._v("#")]),a._v(" Logstash")]),a._v(" "),s("h4",{attrs:{id:"下载-3"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#下载-3"}},[a._v("#")]),a._v(" 下载")]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("https://www.elastic.co/cn/downloads/logstash\n")])])]),s("h4",{attrs:{id:"下载测试数据集-解压后放在logstash根目录"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#下载测试数据集-解压后放在logstash根目录"}},[a._v("#")]),a._v(" 下载测试数据集（解压后放在logstash根目录）")]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("https://grouplens.org/datasets/movielens/\nhttp://files.grouplens.org/datasets/movielens/ml-latest-small.zip\n")])])]),s("h4",{attrs:{id:"下载示例配置文件logstash-conf-放在bin目录下面"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#下载示例配置文件logstash-conf-放在bin目录下面"}},[a._v("#")]),a._v(" 下载示例配置文件logstash.conf (放在bin目录下面)")]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("https://github.com/geektime-geekbang/geektime-ELK/tree/master/part-1/2.4-Logstash%E5%AE%89%E8%A3%85%E4%B8%8E%E5%AF%BC%E5%85%A5%E6%95%B0%E6%8D%AE/movielens/\n")])])]),s("p",[a._v("修改logstash.conf配置文件里面的movies.csv文件路径")]),a._v(" "),s("h4",{attrs:{id:"启动导入数据"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#启动导入数据"}},[a._v("#")]),a._v(" 启动导入数据")]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("cd bin\nsudo ./logstash -f logstash.conf\n")])])]),s("h3",{attrs:{id:"入门"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#入门"}},[a._v("#")]),a._v(" 入门")]),a._v(" "),s("p",[a._v("开发视角（逻辑）：    索引，文档")]),a._v(" "),s("p",[a._v("运维视角（物理）：    节点，分片")]),a._v(" "),s("h4",{attrs:{id:"抽象与类比"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#抽象与类比"}},[a._v("#")]),a._v(" 抽象与类比")]),a._v(" "),s("table",[s("thead",[s("tr",[s("th",[a._v("RDBMS")]),a._v(" "),s("th",[a._v("Elasticsearch")])])]),a._v(" "),s("tbody",[s("tr",[s("td",[a._v("Table")]),a._v(" "),s("td",[a._v("Index(Type)")])]),a._v(" "),s("tr",[s("td",[a._v("Row")]),a._v(" "),s("td",[a._v("Document")])]),a._v(" "),s("tr",[s("td",[a._v("Column")]),a._v(" "),s("td",[a._v("Filed")])]),a._v(" "),s("tr",[s("td",[a._v("Schema")]),a._v(" "),s("td",[a._v("Mapping")])]),a._v(" "),s("tr",[s("td",[a._v("SQL")]),a._v(" "),s("td",[a._v("DSL")])])])]),a._v(" "),s("h4",{attrs:{id:"常见操作dev-tools"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#常见操作dev-tools"}},[a._v("#")]),a._v(" 常见操作dev tools")]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("//查看所有节点\nget /_cat/nodes\n\n//查看索引相关信息\nget movies\n\n//查看索引的文档总数\nget movies/_count\n\n//查看前10条文档\npost movies/_search\n{}\n\n//查看indices\nget /_cat/indices/kibana*?v&s=index\n\n//查看状态为绿色的索引\nget /_cat/indices?v&health=green\n\n//按照文档个数排序\nget /_cat/indices?v&s=docs.count:desc\n\n//查看具体的字段\nget /_cat/indices/kibana*?pri&v&h=health,index,pri,rep,docs,count,mt\n")])])])])}),[],!1,null,null,null);t.default=l.exports}}]);