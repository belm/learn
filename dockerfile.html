<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>dockerfile | 学习笔记</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="icon" href="/learn/favcon.ico">
    <meta name="description" content="学习笔记 Learn Forever">
    
    <link rel="preload" href="/learn/assets/css/0.styles.4b45f7a9.css" as="style"><link rel="preload" href="/learn/assets/js/app.89787527.js" as="script"><link rel="preload" href="/learn/assets/js/2.29f924b0.js" as="script"><link rel="preload" href="/learn/assets/js/10.32aef794.js" as="script"><link rel="prefetch" href="/learn/assets/js/11.953b0cef.js"><link rel="prefetch" href="/learn/assets/js/12.b5e3a75b.js"><link rel="prefetch" href="/learn/assets/js/13.e733a5d0.js"><link rel="prefetch" href="/learn/assets/js/14.eff89a73.js"><link rel="prefetch" href="/learn/assets/js/15.61bc6d70.js"><link rel="prefetch" href="/learn/assets/js/16.98c2e1c0.js"><link rel="prefetch" href="/learn/assets/js/17.ae6bf14f.js"><link rel="prefetch" href="/learn/assets/js/18.1a12f8b9.js"><link rel="prefetch" href="/learn/assets/js/19.e2525f22.js"><link rel="prefetch" href="/learn/assets/js/20.d859c37c.js"><link rel="prefetch" href="/learn/assets/js/21.f52b2071.js"><link rel="prefetch" href="/learn/assets/js/22.76729605.js"><link rel="prefetch" href="/learn/assets/js/23.30119e05.js"><link rel="prefetch" href="/learn/assets/js/24.06c9b636.js"><link rel="prefetch" href="/learn/assets/js/25.89603136.js"><link rel="prefetch" href="/learn/assets/js/3.8cb6babc.js"><link rel="prefetch" href="/learn/assets/js/4.d8037a69.js"><link rel="prefetch" href="/learn/assets/js/5.a779c4f6.js"><link rel="prefetch" href="/learn/assets/js/6.4d299f4b.js"><link rel="prefetch" href="/learn/assets/js/7.ad0d09da.js"><link rel="prefetch" href="/learn/assets/js/8.93d21c50.js"><link rel="prefetch" href="/learn/assets/js/9.c51c4258.js">
    <link rel="stylesheet" href="/learn/assets/css/0.styles.4b45f7a9.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/learn/" class="home-link router-link-active"><!----> <span class="site-name">学习笔记</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="https://www.belmeng.com" target="_blank" rel="noopener noreferrer" class="nav-link external">
  首页
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="https://www.belmeng.com" target="_blank" rel="noopener noreferrer" class="nav-link external">
  文档
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <a href="https://github.com/belm/learn" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="https://www.belmeng.com" target="_blank" rel="noopener noreferrer" class="nav-link external">
  首页
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="https://www.belmeng.com" target="_blank" rel="noopener noreferrer" class="nav-link external">
  文档
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <a href="https://github.com/belm/learn" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>后端</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/learn/" aria-current="page" class="sidebar-link">Learn Forever</a></li><li><a href="/learn/go.html" class="sidebar-link">go</a></li><li><a href="/learn/jupyter.html" class="sidebar-link">jupyter</a></li><li><a href="/learn/mysql.html" class="sidebar-link">MYSQL</a></li><li><a href="/learn/php.html" class="sidebar-link">PHP</a></li><li><a href="/learn/python.html" class="sidebar-link">python</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>运维</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/learn/centos.html" class="sidebar-link">centos</a></li><li><a href="/learn/docker.html" class="sidebar-link">docker</a></li><li><a href="/learn/k8s.html" class="sidebar-link">K8s</a></li><li><a href="/learn/linux.html" class="sidebar-link">linux</a></li><li><a href="/learn/dockerfile.html" aria-current="page" class="active sidebar-link">dockerfile</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/learn/dockerfile.html#简介" class="sidebar-link">简介</a></li><li class="sidebar-sub-header"><a href="/learn/dockerfile.html#指令详解" class="sidebar-link">指令详解</a></li></ul></li><li><a href="/learn/frp.html" class="sidebar-link">frp</a></li><li><a href="/learn/iptables.html" class="sidebar-link">Iptables</a></li><li><a href="/learn/jenkins.html" class="sidebar-link">jenkins</a></li><li><a href="https://pm2.keymetrics.io/" target="_blank" rel="noopener noreferrer" class="sidebar-link">pm2官网<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>大数据</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/learn/elk.html" class="sidebar-link">ELK</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>前端</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/learn/flutter.html" class="sidebar-link">flutter</a></li><li><a href="/learn/nodejs.html" class="sidebar-link">nodejs</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>其他</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/learn/pm2.html" class="sidebar-link">pm2</a></li><li><a href="/learn/supervisor.html" class="sidebar-link">supervisor</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="dockerfile"><a href="#dockerfile" class="header-anchor">#</a> dockerfile</h1> <h2 id="简介"><a href="#简介" class="header-anchor">#</a> 简介</h2> <p>注意：Dockerfile 的指令每执行一次都会在 docker 上新建一层。所以过多无意义的层，会造成镜像膨胀过大。例如：</p> <div class="language- extra-class"><pre class="language-text"><code>FROM centos
RUN yum install wget
RUN wget -O redis.tar.gz &quot;http://download.redis.io/releases/redis-5.0.3.tar.gz&quot;
RUN tar -xvf redis.tar.gz
以上执行会创建 3 层镜像。可简化为以下格式：
FROM centos
RUN yum install wget \
    &amp;&amp; wget -O redis.tar.gz &quot;http://download.redis.io/releases/redis-5.0.3.tar.gz&quot; \
    &amp;&amp; tar -xvf redis.tar.gz
</code></pre></div><p>如上，以 <strong>&amp;&amp;</strong> 符号连接命令，这样执行后，只会创建 1 层镜像。</p> <h3 id="构建镜像"><a href="#构建镜像" class="header-anchor">#</a> 构建镜像</h3> <div class="language- extra-class"><pre class="language-text"><code>docker build -t nginx:v3 .
</code></pre></div><h3 id="from"><a href="#from" class="header-anchor">#</a> FROM</h3> <div class="language- extra-class"><pre class="language-text"><code>FROM：定制的镜像都是基于 FROM 的镜像，这里的 nginx 就是定制需要的基础镜像。后续的操作都是基于 nginx。
</code></pre></div><h3 id="run"><a href="#run" class="header-anchor">#</a> RUN</h3> <div class="language- extra-class"><pre class="language-text"><code>RUN：用于执行后面跟着的命令行命令。有以下俩种格式：

shell 格式：
RUN &lt;命令行命令&gt;
# &lt;命令行命令&gt; 等同于，在终端操作的 shell 命令。

exec 格式：
RUN [&quot;可执行文件&quot;, &quot;参数1&quot;, &quot;参数2&quot;]
# RUN [&quot;./test.php&quot;, &quot;dev&quot;, &quot;offline&quot;] 等价于 RUN ./test.php dev offline
</code></pre></div><h2 id="指令详解"><a href="#指令详解" class="header-anchor">#</a> 指令详解</h2> <h3 id="copy"><a href="#copy" class="header-anchor">#</a> COPY</h3> <p>复制指令，从上下文目录中复制文件或者目录到容器里指定路径。</p> <p>格式：</p> <div class="language- extra-class"><pre class="language-text"><code>COPY [--chown=&lt;user&gt;:&lt;group&gt;] &lt;源路径1&gt;...  &lt;目标路径&gt;
COPY [--chown=&lt;user&gt;:&lt;group&gt;] [&quot;&lt;源路径1&gt;&quot;,...  &quot;&lt;目标路径&gt;&quot;]
</code></pre></div><p><strong>[--chown=<user>:<group>]</group></user></strong>：可选参数，用户改变复制到容器内文件的拥有者和属组。</p> <p><strong>&lt;源路径&gt;</strong>：源文件或者源目录，这里可以是通配符表达式，其通配符规则要满足 Go 的 filepath.Match 规则。例如：</p> <div class="language- extra-class"><pre class="language-text"><code>COPY hom* /mydir/
COPY hom?.txt /mydir/
</code></pre></div><p><strong>&lt;目标路径&gt;</strong>：容器内的指定路径，该路径不用事先建好，路径不存在的话，会自动创建。</p> <h3 id="add"><a href="#add" class="header-anchor">#</a> ADD</h3> <p>ADD 指令和 COPY 的使用格式一致（同样需求下，官方推荐使用 COPY）。功能也类似，不同之处如下：</p> <ul><li>ADD 的优点：在执行 &lt;源文件&gt; 为 tar 压缩文件的话，压缩格式为 gzip, bzip2 以及 xz 的情况下，会自动复制并解压到 &lt;目标路径&gt;。</li> <li>ADD 的缺点：在不解压的前提下，无法复制 tar 压缩文件。会令镜像构建缓存失效，从而可能会令镜像构建变得比较缓慢。具体是否使用，可以根据是否需要自动解压来决定。</li></ul> <h3 id="cmd"><a href="#cmd" class="header-anchor">#</a> CMD</h3> <p>类似于 RUN 指令，用于运行程序，但二者运行的时间点不同:</p> <ul><li>CMD 在docker run 时运行。</li> <li>RUN 是在 docker build。</li></ul> <p><strong>作用</strong>：为启动的容器指定默认要运行的程序，程序运行结束，容器也就结束。CMD 指令指定的程序可被 docker run 命令行参数中指定要运行的程序所覆盖。</p> <p><strong>注意</strong>：如果 Dockerfile 中如果存在多个 CMD 指令，仅最后一个生效。</p> <p>格式：</p> <div class="language- extra-class"><pre class="language-text"><code>CMD &lt;shell 命令&gt; 
CMD [&quot;&lt;可执行文件或命令&gt;&quot;,&quot;&lt;param1&gt;&quot;,&quot;&lt;param2&gt;&quot;,...] 
CMD [&quot;&lt;param1&gt;&quot;,&quot;&lt;param2&gt;&quot;,...]  # 该写法是为 ENTRYPOINT 指令指定的程序提供默认参数
</code></pre></div><p>推荐使用第二种格式，执行过程比较明确。第一种格式实际上在运行的过程中也会自动转换成第二种格式运行，并且默认可执行文件是 sh。</p> <h3 id="entrypoint"><a href="#entrypoint" class="header-anchor">#</a> ENTRYPOINT</h3> <p>类似于 CMD 指令，但其不会被 docker run 的命令行参数指定的指令所覆盖，而且这些命令行参数会被当作参数送给 ENTRYPOINT 指令指定的程序。</p> <p>但是, 如果运行 docker run 时使用了 --entrypoint 选项，此选项的参数可当作要运行的程序覆盖 ENTRYPOINT 指令指定的程序。</p> <p><strong>优点</strong>：在执行 docker run 的时候可以指定 ENTRYPOINT 运行所需的参数。</p> <p><strong>注意</strong>：如果 Dockerfile 中如果存在多个 ENTRYPOINT 指令，仅最后一个生效。</p> <p>格式：</p> <div class="language- extra-class"><pre class="language-text"><code>ENTRYPOINT [&quot;&lt;executeable&gt;&quot;,&quot;&lt;param1&gt;&quot;,&quot;&lt;param2&gt;&quot;,...]
</code></pre></div><p>可以搭配 CMD 命令使用：一般是变参才会使用 CMD ，这里的 CMD 等于是在给 ENTRYPOINT 传参，以下示例会提到。</p> <p>示例：</p> <p>假设已通过 Dockerfile 构建了 nginx:test 镜像：</p> <div class="language- extra-class"><pre class="language-text"><code>FROM nginx

ENTRYPOINT [&quot;nginx&quot;, &quot;-c&quot;] # 定参
CMD [&quot;/etc/nginx/nginx.conf&quot;] # 变参 
</code></pre></div><p>1、不传参运行</p> <div class="language- extra-class"><pre class="language-text"><code>$ docker run  nginx:test
</code></pre></div><p>容器内会默认运行以下命令，启动主进程。</p> <div class="language- extra-class"><pre class="language-text"><code>nginx -c /etc/nginx/nginx.conf
</code></pre></div><p>2、传参运行</p> <div class="language- extra-class"><pre class="language-text"><code>$ docker run  nginx:test -c /etc/nginx/new.conf
</code></pre></div><p>容器内会默认运行以下命令，启动主进程(/etc/nginx/new.conf:假设容器内已有此文件)</p> <div class="language- extra-class"><pre class="language-text"><code>nginx -c /etc/nginx/new.conf
</code></pre></div><h3 id="env"><a href="#env" class="header-anchor">#</a> ENV</h3> <p>设置环境变量，定义了环境变量，那么在后续的指令中，就可以使用这个环境变量。</p> <p>格式：</p> <div class="language- extra-class"><pre class="language-text"><code>ENV &lt;key&gt; &lt;value&gt;
ENV &lt;key1&gt;=&lt;value1&gt; &lt;key2&gt;=&lt;value2&gt;...
</code></pre></div><p>以下示例设置 NODE_VERSION = 7.2.0 ， 在后续的指令中可以通过 $NODE_VERSION 引用：</p> <div class="language- extra-class"><pre class="language-text"><code>ENV NODE_VERSION 7.2.0

RUN curl -SLO &quot;https://nodejs.org/dist/v$NODE_VERSION/node-v$NODE_VERSION-linux-x64.tar.xz&quot; \
  &amp;&amp; curl -SLO &quot;https://nodejs.org/dist/v$NODE_VERSION/SHASUMS256.txt.asc&quot;
</code></pre></div><h3 id="arg"><a href="#arg" class="header-anchor">#</a> ARG</h3> <p>构建参数，与 ENV 作用一至。不过作用域不一样。ARG 设置的环境变量仅对 Dockerfile 内有效，也就是说只有 docker build 的过程中有效，构建好的镜像内不存在此环境变量。</p> <p>构建命令 docker build 中可以用 --build-arg &lt;参数名&gt;=&lt;值&gt; 来覆盖。</p> <p>格式：</p> <div class="language- extra-class"><pre class="language-text"><code>ARG &lt;参数名&gt;[=&lt;默认值&gt;]
</code></pre></div><h3 id="volume"><a href="#volume" class="header-anchor">#</a> VOLUME</h3> <p>定义匿名数据卷。在启动容器时忘记挂载数据卷，会自动挂载到匿名卷。</p> <p>作用：</p> <ul><li>避免重要的数据，因容器重启而丢失，这是非常致命的。</li> <li>避免容器不断变大。</li></ul> <p>格式：</p> <div class="language- extra-class"><pre class="language-text"><code>VOLUME [&quot;&lt;路径1&gt;&quot;, &quot;&lt;路径2&gt;&quot;...]
VOLUME &lt;路径&gt;
</code></pre></div><p>在启动容器 docker run 的时候，我们可以通过 -v 参数修改挂载点。</p> <h3 id="expose"><a href="#expose" class="header-anchor">#</a> EXPOSE</h3> <p>仅仅只是声明端口。</p> <p>作用：</p> <ul><li>帮助镜像使用者理解这个镜像服务的守护端口，以方便配置映射。</li> <li>在运行时使用随机端口映射时，也就是 docker run -P 时，会自动随机映射 EXPOSE 的端口。</li></ul> <p>格式：</p> <div class="language- extra-class"><pre class="language-text"><code>EXPOSE &lt;端口1&gt; [&lt;端口2&gt;...]
</code></pre></div><h3 id="workdir"><a href="#workdir" class="header-anchor">#</a> WORKDIR</h3> <p>指定工作目录。用 WORKDIR 指定的工作目录，会在构建镜像的每一层中都存在。（WORKDIR 指定的工作目录，必须是提前创建好的）。</p> <p>docker build 构建镜像过程中的，每一个 RUN 命令都是新建的一层。只有通过 WORKDIR 创建的目录才会一直存在。</p> <p>格式：</p> <div class="language- extra-class"><pre class="language-text"><code>WORKDIR &lt;工作目录路径&gt;
</code></pre></div><h3 id="user"><a href="#user" class="header-anchor">#</a> USER</h3> <p>用于指定执行后续命令的用户和用户组，这边只是切换后续命令执行的用户（用户和用户组必须提前已经存在）。</p> <p>格式：</p> <div class="language- extra-class"><pre class="language-text"><code>USER &lt;用户名&gt;[:&lt;用户组&gt;]
</code></pre></div><h3 id="healthcheck"><a href="#healthcheck" class="header-anchor">#</a> HEALTHCHECK</h3> <p>用于指定某个程序或者指令来监控 docker 容器服务的运行状态。</p> <p>格式：</p> <div class="language- extra-class"><pre class="language-text"><code>HEALTHCHECK [选项] CMD &lt;命令&gt;：设置检查容器健康状况的命令
HEALTHCHECK NONE：如果基础镜像有健康检查指令，使用这行可以屏蔽掉其健康检查指令

HEALTHCHECK [选项] CMD &lt;命令&gt; : 这边 CMD 后面跟随的命令使用，可以参考 CMD 的用法。
</code></pre></div><h3 id="onbuild"><a href="#onbuild" class="header-anchor">#</a> ONBUILD</h3> <p>用于延迟构建命令的执行。简单的说，就是 Dockerfile 里用 ONBUILD 指定的命令，在本次构建镜像的过程中不会执行（假设镜像为 test-build）。当有新的 Dockerfile 使用了之前构建的镜像 FROM test-build ，这是执行新镜像的 Dockerfile 构建时候，会执行 test-build 的 Dockerfile 里的 ONBUILD 指定的命令。</p> <p>格式：</p> <div class="language- extra-class"><pre class="language-text"><code>ONBUILD &lt;其它指令&gt;
</code></pre></div></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/belm/learn/edit/master/docs/dockerfile.md" target="_blank" rel="noopener noreferrer">在Github上编辑</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">2021/3/9 下午2:49:06</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/learn/linux.html" class="prev">
        linux
      </a></span> <span class="next"><a href="/learn/frp.html">
        frp
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/learn/assets/js/app.89787527.js" defer></script><script src="/learn/assets/js/2.29f924b0.js" defer></script><script src="/learn/assets/js/10.32aef794.js" defer></script>
  </body>
</html>
